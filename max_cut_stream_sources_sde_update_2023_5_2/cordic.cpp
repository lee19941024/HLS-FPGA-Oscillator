
#include "f_func.h"

void cordic_sin(FIXED_POINT_PRECISION theta, FIXED_POINT_U_PRECISION* sin)

{
    #pragma HLS pipeline 
    const FIXED_POINT_U_PRECISION cordic_phase[32]={0.78539816339744828000,0.46364760900080609000,0.24497866312686414000,0.12435499454676144000,0.06241880999595735000,0.03123983343026827700,0.01562372862047683100,0.00781234106010111110,0.00390623013196697180,0.00195312251647881880,0.00097656218955931946,0.00048828121119489829,0.00024414062014936177,0.00012207031189367021,0.00006103515617420877,0.00003051757811552610,0.00001525878906131576,0.00000762939453110197,0.00000381469726560650,0.00000190734863281019,0.00000095367431640596,0.00000047683715820309,0.00000023841857910156,0.00000011920928955078,0.00000005960464477539,0.00000002980232238770,0.00000001490116119385,0.00000000745058059692,0.00000000372529029846,0.00000000186264514923,0.00000000093132257462,0.00000000046566128731};
    const FIXED_POINT_U_PRECISION sin_lut[512]={0,0.003067957,0.006135885,0.009203754,0.01227154,0.01533921,0.01840673,0.02147408,0.02454123,0.02760815,0.0306748,0.03374117,0.03680722,0.03987293,0.04293826,0.04600318,0.04906768,0.0521317,0.05519525,0.05825827,0.06132074,0.06438263,0.06744392,0.07050458,0.07356457,0.07662386,0.07968244,0.08274026,0.08579731,0.08885355,0.09190895,0.0949635,0.09801714,0.1010699,0.1041216,0.1071724,0.1102222,0.113271,0.1163186,0.1193652,0.1224107,0.125455,0.1284981,0.13154,0.1345807,0.1376201,0.1406582,0.143695,0.1467305,0.1497645,0.1527972,0.1558284,0.1588582,0.1618864,0.1649131,0.1679383,0.1709619,0.1739839,0.1770042,0.1800229,0.1830399,0.1860552,0.1890687,0.1920804,0.1950903,0.1980984,0.2011046,0.204109,0.2071114,0.2101118,0.2131103,0.2161068,0.2191012,0.2220936,0.2250839,0.2280721,0.2310581,0.234042,0.2370236,0.240003,0.2429802,0.245955,0.2489276,0.2518978,0.2548656,0.2578311,0.2607941,0.2637547,0.2667128,0.2696683,0.2726214,0.2755718,0.2785197,0.2814649,0.2844075,0.2873475,0.2902847,0.2932191,0.2961509,0.2990798,0.3020059,0.3049292,0.3078496,0.3107671,0.3136818,0.3165934,0.319502,0.3224077,0.3253103,0.3282098,0.3311063,0.3339997,0.3368899,0.3397769,0.3426607,0.3455413,0.3484187,0.3512928,0.3541635,0.357031,0.3598951,0.3627557,0.365613,0.3684668,0.3713172,0.3741641,0.3770074,0.3798472,0.3826834,0.385516,0.388345,0.3911704,0.393992,0.39681,0.3996242,0.4024346,0.4052413,0.4080442,0.4108432,0.4136383,0.4164295,0.4192169,0.4220003,0.4247797,0.4275551,0.4303265,0.4330938,0.4358571,0.4386162,0.4413713,0.4441221,0.4468688,0.4496113,0.4523496,0.4550836,0.4578133,0.4605387,0.4632598,0.4659765,0.4686888,0.4713967,0.4741002,0.4767992,0.4794938,0.4821838,0.4848692,0.4875502,0.4902265,0.4928982,0.4955653,0.4982277,0.5008854,0.5035384,0.5061867,0.5088301,0.5114688,0.5141028,0.5167318,0.519356,0.5219753,0.5245897,0.5271991,0.5298036,0.5324031,0.5349976,0.537587,0.5401714,0.5427508,0.545325,0.5478941,0.550458,0.5530167,0.5555702,0.5581185,0.5606616,0.5631993,0.5657318,0.5682589,0.5707808,0.5732971,0.5758082,0.5783138,0.5808139,0.5833086,0.5857978,0.5882816,0.5907597,0.5932323,0.5956993,0.5981607,0.6006165,0.6030666,0.6055111,0.6079498,0.6103828,0.6128101,0.6152316,0.6176473,0.6200572,0.6224613,0.6248595,0.6272518,0.6296383,0.6320187,0.6343933,0.6367618,0.6391245,0.641481,0.6438316,0.646176,0.6485144,0.6508467,0.6531729,0.6554928,0.6578067,0.6601143,0.6624158,0.664711,0.6669999,0.6692826,0.671559,0.673829,0.6760927,0.67835,0.680601,0.6828455,0.6850837,0.6873153,0.6895406,0.6917592,0.6939715,0.6961771,0.6983762,0.7005688,0.7027547,0.7049341,0.7071068,0.7092728,0.7114322,0.7135848,0.7157308,0.7178701,0.7200025,0.7221282,0.7242471,0.7263591,0.7284644,0.7305627,0.7326543,0.7347389,0.7368166,0.7388873,0.7409511,0.743008,0.7450578,0.7471006,0.7491364,0.7511652,0.7531868,0.7552014,0.7572088,0.7592092,0.7612024,0.7631884,0.7651672,0.7671389,0.7691033,0.7710605,0.7730104,0.7749531,0.7768885,0.7788165,0.7807372,0.7826506,0.7845566,0.7864552,0.7883464,0.7902302,0.7921066,0.7939755,0.7958369,0.7976909,0.7995372,0.8013762,0.8032075,0.8050314,0.8068476,0.8086562,0.8104572,0.8122506,0.8140363,0.8158144,0.8175848,0.8193475,0.8211025,0.8228498,0.8245893,0.8263211,0.8280451,0.8297612,0.8314696,0.8331702,0.8348629,0.8365477,0.8382247,0.8398938,0.841555,0.8432083,0.8448536,0.8464909,0.8481203,0.8497418,0.8513552,0.8529606,0.854558,0.8561473,0.8577286,0.8593018,0.860867,0.862424,0.8639728,0.8655136,0.8670462,0.8685707,0.870087,0.8715951,0.873095,0.8745866,0.8760701,0.8775453,0.8790122,0.8804709,0.8819213,0.8833634,0.8847971,0.8862225,0.8876396,0.8890483,0.8904487,0.8918407,0.8932243,0.8945995,0.8959662,0.8973246,0.8986745,0.9000159,0.9013488,0.9026733,0.9039893,0.9052967,0.9065957,0.9078861,0.909168,0.9104413,0.911706,0.9129622,0.9142098,0.9154487,0.9166791,0.9179008,0.9191139,0.9203183,0.921514,0.9227011,0.9238795,0.9250492,0.9262102,0.9273625,0.9285061,0.9296409,0.9307669,0.9318843,0.9329928,0.9340925,0.9351835,0.9362656,0.937339,0.9384035,0.9394592,0.940506,0.9415441,0.9425732,0.9435934,0.9446048,0.9456073,0.9466009,0.9475856,0.9485614,0.9495282,0.9504861,0.951435,0.952375,0.953306,0.9542281,0.9551412,0.9560453,0.9569404,0.9578264,0.9587035,0.9595715,0.9604305,0.9612805,0.9621214,0.9629533,0.9637761,0.9645898,0.9653944,0.96619,0.9669765,0.9677538,0.9685221,0.9692813,0.9700313,0.9707721,0.9715039,0.9722265,0.97294,0.9736443,0.9743394,0.9750254,0.9757021,0.9763697,0.9770281,0.9776773,0.9783174,0.9789482,0.9795698,0.9801821,0.9807853,0.9813792,0.9819639,0.9825393,0.9831055,0.9836624,0.9842101,0.9847485,0.9852777,0.9857975,0.9863081,0.9868094,0.9873014,0.9877841,0.9882576,0.9887217,0.9891765,0.989622,0.9900582,0.9904851,0.9909027,0.9913108,0.9917098,0.9920993,0.9924796,0.9928504,0.9932119,0.9935641,0.993907,0.9942405,0.9945646,0.9948793,0.9951847,0.9954808,0.9957674,0.9960447,0.9963126,0.9965711,0.9968203,0.9970601,0.9972904,0.9975114,0.997723,0.9979253,0.9981181,0.9983016,0.9984756,0.9986402,0.9987954,0.9989413,0.9990777,0.9992048,0.9993224,0.9994306,0.9995294,0.9996188,0.9996988,0.9997694,0.9998306,0.9998823,0.9999247,0.9999576,0.9999812,0.9999953};
    const FIXED_POINT_U_PRECISION cos_lut[512]={1,0.9999953,0.9999812,0.9999576,0.9999247,0.9998823,0.9998306,0.9997694,0.9996988,0.9996188,0.9995294,0.9994306,0.9993224,0.9992048,0.9990777,0.9989413,0.9987954,0.9986402,0.9984756,0.9983016,0.9981181,0.9979253,0.997723,0.9975114,0.9972904,0.9970601,0.9968203,0.9965711,0.9963126,0.9960447,0.9957674,0.9954808,0.9951847,0.9948793,0.9945646,0.9942405,0.993907,0.9935641,0.9932119,0.9928504,0.9924796,0.9920993,0.9917098,0.9913108,0.9909027,0.9904851,0.9900582,0.989622,0.9891765,0.9887217,0.9882576,0.9877841,0.9873014,0.9868094,0.9863081,0.9857975,0.9852777,0.9847485,0.9842101,0.9836624,0.9831055,0.9825393,0.9819639,0.9813792,0.9807853,0.9801821,0.9795698,0.9789482,0.9783174,0.9776773,0.9770281,0.9763697,0.9757021,0.9750254,0.9743394,0.9736443,0.97294,0.9722265,0.9715039,0.9707721,0.9700313,0.9692813,0.9685221,0.9677538,0.9669765,0.96619,0.9653944,0.9645898,0.9637761,0.9629533,0.9621214,0.9612805,0.9604305,0.9595715,0.9587035,0.9578264,0.9569404,0.9560453,0.9551412,0.9542281,0.953306,0.952375,0.951435,0.9504861,0.9495282,0.9485614,0.9475856,0.9466009,0.9456073,0.9446048,0.9435934,0.9425732,0.9415441,0.940506,0.9394592,0.9384035,0.937339,0.9362656,0.9351835,0.9340925,0.9329928,0.9318843,0.9307669,0.9296409,0.9285061,0.9273625,0.9262102,0.9250492,0.9238795,0.9227011,0.921514,0.9203183,0.9191139,0.9179008,0.9166791,0.9154487,0.9142098,0.9129622,0.911706,0.9104413,0.909168,0.9078861,0.9065957,0.9052967,0.9039893,0.9026733,0.9013488,0.9000159,0.8986745,0.8973246,0.8959662,0.8945995,0.8932243,0.8918407,0.8904487,0.8890483,0.8876396,0.8862225,0.8847971,0.8833634,0.8819213,0.8804709,0.8790122,0.8775453,0.8760701,0.8745866,0.873095,0.8715951,0.870087,0.8685707,0.8670462,0.8655136,0.8639728,0.862424,0.860867,0.8593018,0.8577286,0.8561473,0.854558,0.8529606,0.8513552,0.8497418,0.8481203,0.8464909,0.8448536,0.8432083,0.841555,0.8398938,0.8382247,0.8365477,0.8348629,0.8331702,0.8314696,0.8297612,0.8280451,0.8263211,0.8245893,0.8228498,0.8211025,0.8193475,0.8175848,0.8158144,0.8140363,0.8122506,0.8104572,0.8086562,0.8068476,0.8050314,0.8032075,0.8013762,0.7995372,0.7976909,0.7958369,0.7939755,0.7921066,0.7902302,0.7883464,0.7864552,0.7845566,0.7826506,0.7807372,0.7788165,0.7768885,0.7749531,0.7730104,0.7710605,0.7691033,0.7671389,0.7651672,0.7631884,0.7612024,0.7592092,0.7572088,0.7552014,0.7531868,0.7511652,0.7491364,0.7471006,0.7450578,0.743008,0.7409511,0.7388873,0.7368166,0.7347389,0.7326543,0.7305627,0.7284644,0.7263591,0.7242471,0.7221282,0.7200025,0.7178701,0.7157308,0.7135848,0.7114322,0.7092728,0.7071068,0.7049341,0.7027547,0.7005688,0.6983762,0.6961771,0.6939715,0.6917592,0.6895406,0.6873153,0.6850837,0.6828455,0.680601,0.67835,0.6760927,0.673829,0.671559,0.6692826,0.6669999,0.664711,0.6624158,0.6601143,0.6578067,0.6554928,0.6531729,0.6508467,0.6485144,0.646176,0.6438316,0.641481,0.6391245,0.6367618,0.6343933,0.6320187,0.6296383,0.6272518,0.6248595,0.6224613,0.6200572,0.6176473,0.6152316,0.6128101,0.6103828,0.6079498,0.6055111,0.6030666,0.6006165,0.5981607,0.5956993,0.5932323,0.5907597,0.5882816,0.5857978,0.5833086,0.5808139,0.5783138,0.5758082,0.5732971,0.5707808,0.5682589,0.5657318,0.5631993,0.5606616,0.5581185,0.5555702,0.5530167,0.550458,0.5478941,0.545325,0.5427508,0.5401714,0.537587,0.5349976,0.5324031,0.5298036,0.5271991,0.5245897,0.5219753,0.519356,0.5167318,0.5141028,0.5114688,0.5088301,0.5061867,0.5035384,0.5008854,0.4982277,0.4955653,0.4928982,0.4902265,0.4875502,0.4848692,0.4821838,0.4794938,0.4767992,0.4741002,0.4713967,0.4686888,0.4659765,0.4632598,0.4605387,0.4578133,0.4550836,0.4523496,0.4496113,0.4468688,0.4441221,0.4413713,0.4386162,0.4358571,0.4330938,0.4303265,0.4275551,0.4247797,0.4220003,0.4192169,0.4164295,0.4136383,0.4108432,0.4080442,0.4052413,0.4024346,0.3996242,0.39681,0.393992,0.3911704,0.388345,0.385516,0.3826834,0.3798472,0.3770074,0.3741641,0.3713172,0.3684668,0.365613,0.3627557,0.3598951,0.357031,0.3541635,0.3512928,0.3484187,0.3455413,0.3426607,0.3397769,0.3368899,0.3339997,0.3311063,0.3282098,0.3253103,0.3224077,0.319502,0.3165934,0.3136818,0.3107671,0.3078496,0.3049292,0.3020059,0.2990798,0.2961509,0.2932191,0.2902847,0.2873475,0.2844075,0.2814649,0.2785197,0.2755718,0.2726214,0.2696683,0.2667128,0.2637547,0.2607941,0.2578311,0.2548656,0.2518978,0.2489276,0.245955,0.2429802,0.240003,0.2370236,0.234042,0.2310581,0.2280721,0.2250839,0.2220936,0.2191012,0.2161068,0.2131103,0.2101118,0.2071114,0.204109,0.2011046,0.1980984,0.1950903,0.1920804,0.1890687,0.1860552,0.1830399,0.1800229,0.1770042,0.1739839,0.1709619,0.1679383,0.1649131,0.1618864,0.1588582,0.1558284,0.1527972,0.1497645,0.1467305,0.143695,0.1406582,0.1376201,0.1345807,0.13154,0.1284981,0.125455,0.1224107,0.1193652,0.1163186,0.113271,0.1102222,0.1071724,0.1041216,0.1010699,0.09801714,0.0949635,0.09190895,0.08885355,0.08579731,0.08274026,0.07968244,0.07662386,0.07356457,0.07050458,0.06744392,0.06438263,0.06132074,0.05825827,0.05519525,0.0521317,0.04906768,0.04600318,0.04293826,0.03987293,0.03680722,0.03374117,0.0306748,0.02760815,0.02454123,0.02147408,0.01840673,0.01533921,0.01227154,0.009203754,0.006135885,0.003067957};
    const FIXED_POINT_PRECISION theta_lut[512]={0,0.00306796157577128,0.00613592315154256,0.00920388472731385,0.0122718463030851,0.0153398078788564,0.0184077694546277,0.021475731030399,0.0245436926061703,0.0276116541819415,0.0306796157577128,0.0337475773334841,0.0368155389092554,0.0398835004850267,0.042951462060798,0.0460194236365692,0.0490873852123405,0.0521553467881118,0.0552233083638831,0.0582912699396544,0.0613592315154256,0.0644271930911969,0.0674951546669682,0.0705631162427395,0.0736310778185108,0.0766990393942821,0.0797670009700533,0.0828349625458246,0.0859029241215959,0.0889708856973672,0.0920388472731385,0.0951068088489097,0.098174770424681,0.101242732000452,0.104310693576224,0.107378655151995,0.110446616727766,0.113514578303537,0.116582539879309,0.11965050145508,0.122718463030851,0.125786424606623,0.128854386182394,0.131922347758165,0.134990309333936,0.138058270909708,0.141126232485479,0.14419419406125,0.147262155637022,0.150330117212793,0.153398078788564,0.156466040364335,0.159534001940107,0.162601963515878,0.165669925091649,0.168737886667421,0.171805848243192,0.174873809818963,0.177941771394734,0.181009732970506,0.184077694546277,0.187145656122048,0.190213617697819,0.193281579273591,0.196349540849362,0.199417502425133,0.202485464000905,0.205553425576676,0.208621387152447,0.211689348728218,0.21475731030399,0.217825271879761,0.220893233455532,0.223961195031304,0.227029156607075,0.230097118182846,0.233165079758617,0.236233041334389,0.23930100291016,0.242368964485931,0.245436926061703,0.248504887637474,0.251572849213245,0.254640810789016,0.257708772364788,0.260776733940559,0.26384469551633,0.266912657092102,0.269980618667873,0.273048580243644,0.276116541819415,0.279184503395187,0.282252464970958,0.285320426546729,0.288388388122501,0.291456349698272,0.294524311274043,0.297592272849814,0.300660234425586,0.303728196001357,0.306796157577128,0.3098641191529,0.312932080728671,0.316000042304442,0.319068003880213,0.322135965455985,0.325203927031756,0.328271888607527,0.331339850183298,0.33440781175907,0.337475773334841,0.340543734910612,0.343611696486384,0.346679658062155,0.349747619637926,0.352815581213697,0.355883542789469,0.35895150436524,0.362019465941011,0.365087427516783,0.368155389092554,0.371223350668325,0.374291312244096,0.377359273819868,0.380427235395639,0.38349519697141,0.386563158547182,0.389631120122953,0.392699081698724,0.395767043274495,0.398835004850267,0.401902966426038,0.404970928001809,0.408038889577581,0.411106851153352,0.414174812729123,0.417242774304894,0.420310735880666,0.423378697456437,0.426446659032208,0.42951462060798,0.432582582183751,0.435650543759522,0.438718505335293,0.441786466911065,0.444854428486836,0.447922390062607,0.450990351638379,0.45405831321415,0.457126274789921,0.460194236365692,0.463262197941464,0.466330159517235,0.469398121093006,0.472466082668777,0.475534044244549,0.47860200582032,0.481669967396091,0.484737928971863,0.487805890547634,0.490873852123405,0.493941813699176,0.497009775274948,0.500077736850719,0.50314569842649,0.506213660002262,0.509281621578033,0.512349583153804,0.515417544729575,0.518485506305347,0.521553467881118,0.524621429456889,0.527689391032661,0.530757352608432,0.533825314184203,0.536893275759974,0.539961237335746,0.543029198911517,0.546097160487288,0.54916512206306,0.552233083638831,0.555301045214602,0.558369006790373,0.561436968366145,0.564504929941916,0.567572891517687,0.570640853093458,0.57370881466923,0.576776776245001,0.579844737820772,0.582912699396544,0.585980660972315,0.589048622548086,0.592116584123857,0.595184545699629,0.5982525072754,0.601320468851171,0.604388430426943,0.607456392002714,0.610524353578485,0.613592315154256,0.616660276730028,0.619728238305799,0.62279619988157,0.625864161457342,0.628932123033113,0.632000084608884,0.635068046184655,0.638136007760427,0.641203969336198,0.644271930911969,0.647339892487741,0.650407854063512,0.653475815639283,0.656543777215054,0.659611738790826,0.662679700366597,0.665747661942368,0.66881562351814,0.671883585093911,0.674951546669682,0.678019508245453,0.681087469821225,0.684155431396996,0.687223392972767,0.690291354548539,0.69335931612431,0.696427277700081,0.699495239275852,0.702563200851624,0.705631162427395,0.708699124003166,0.711767085578938,0.714835047154709,0.71790300873048,0.720970970306251,0.724038931882023,0.727106893457794,0.730174855033565,0.733242816609336,0.736310778185108,0.739378739760879,0.74244670133665,0.745514662912422,0.748582624488193,0.751650586063964,0.754718547639735,0.757786509215507,0.760854470791278,0.763922432367049,0.766990393942821,0.770058355518592,0.773126317094363,0.776194278670134,0.779262240245906,0.782330201821677,0.785398163397448,0.78846612497322,0.791534086548991,0.794602048124762,0.797670009700533,0.800737971276305,0.803805932852076,0.806873894427847,0.809941856003619,0.81300981757939,0.816077779155161,0.819145740730932,0.822213702306704,0.825281663882475,0.828349625458246,0.831417587034017,0.834485548609789,0.83755351018556,0.840621471761331,0.843689433337103,0.846757394912874,0.849825356488645,0.852893318064416,0.855961279640188,0.859029241215959,0.86209720279173,0.865165164367502,0.868233125943273,0.871301087519044,0.874369049094815,0.877437010670587,0.880504972246358,0.883572933822129,0.886640895397901,0.889708856973672,0.892776818549443,0.895844780125214,0.898912741700986,0.901980703276757,0.905048664852528,0.9081166264283,0.911184588004071,0.914252549579842,0.917320511155613,0.920388472731385,0.923456434307156,0.926524395882927,0.929592357458699,0.93266031903447,0.935728280610241,0.938796242186012,0.941864203761784,0.944932165337555,0.948000126913326,0.951068088489098,0.954136050064869,0.95720401164064,0.960271973216411,0.963339934792183,0.966407896367954,0.969475857943725,0.972543819519497,0.975611781095268,0.978679742671039,0.98174770424681,0.984815665822582,0.987883627398353,0.990951588974124,0.994019550549895,0.997087512125667,1.00015547370144,1.00322343527721,1.00629139685298,1.00935935842875,1.01242732000452,1.01549528158029,1.01856324315607,1.02163120473184,1.02469916630761,1.02776712788338,1.03083508945915,1.03390305103492,1.03697101261069,1.04003897418646,1.04310693576224,1.04617489733801,1.04924285891378,1.05231082048955,1.05537878206532,1.05844674364109,1.06151470521686,1.06458266679264,1.06765062836841,1.07071858994418,1.07378655151995,1.07685451309572,1.07992247467149,1.08299043624726,1.08605839782303,1.08912635939881,1.09219432097458,1.09526228255035,1.09833024412612,1.10139820570189,1.10446616727766,1.10753412885343,1.1106020904292,1.11367005200498,1.11673801358075,1.11980597515652,1.12287393673229,1.12594189830806,1.12900985988383,1.1320778214596,1.13514578303537,1.13821374461115,1.14128170618692,1.14434966776269,1.14741762933846,1.15048559091423,1.15355355249,1.15662151406577,1.15968947564154,1.16275743721732,1.16582539879309,1.16889336036886,1.17196132194463,1.1750292835204,1.17809724509617,1.18116520667194,1.18423316824771,1.18730112982349,1.19036909139926,1.19343705297503,1.1965050145508,1.19957297612657,1.20264093770234,1.20570889927811,1.20877686085389,1.21184482242966,1.21491278400543,1.2179807455812,1.22104870715697,1.22411666873274,1.22718463030851,1.23025259188428,1.23332055346006,1.23638851503583,1.2394564766116,1.24252443818737,1.24559239976314,1.24866036133891,1.25172832291468,1.25479628449045,1.25786424606623,1.260932207642,1.26400016921777,1.26706813079354,1.27013609236931,1.27320405394508,1.27627201552085,1.27933997709662,1.2824079386724,1.28547590024817,1.28854386182394,1.29161182339971,1.29467978497548,1.29774774655125,1.30081570812702,1.30388366970279,1.30695163127857,1.31001959285434,1.31308755443011,1.31615551600588,1.31922347758165,1.32229143915742,1.32535940073319,1.32842736230897,1.33149532388474,1.33456328546051,1.33763124703628,1.34069920861205,1.34376717018782,1.34683513176359,1.34990309333936,1.35297105491514,1.35603901649091,1.35910697806668,1.36217493964245,1.36524290121822,1.36831086279399,1.37137882436976,1.37444678594553,1.37751474752131,1.38058270909708,1.38365067067285,1.38671863224862,1.38978659382439,1.39285455540016,1.39592251697593,1.3989904785517,1.40205844012748,1.40512640170325,1.40819436327902,1.41126232485479,1.41433028643056,1.41739824800633,1.4204662095821,1.42353417115788,1.42660213273365,1.42967009430942,1.43273805588519,1.43580601746096,1.43887397903673,1.4419419406125,1.44500990218827,1.44807786376405,1.45114582533982,1.45421378691559,1.45728174849136,1.46034971006713,1.4634176716429,1.46648563321867,1.46955359479444,1.47262155637022,1.47568951794599,1.47875747952176,1.48182544109753,1.4848934026733,1.48796136424907,1.49102932582484,1.49409728740061,1.49716524897639,1.50023321055216,1.50330117212793,1.5063691337037,1.50943709527947,1.51250505685524,1.51557301843101,1.51864098000678,1.52170894158256,1.52477690315833,1.5278448647341,1.53091282630987,1.53398078788564,1.53704874946141,1.54011671103718,1.54318467261295,1.54625263418873,1.5493205957645,1.55238855734027,1.55545651891604,1.55852448049181,1.56159244206758,1.56466040364335,1.56772836521913};
    const int START_ITERATION=9;//log2 (lut_size)
    const FIXED_POINT_U_PRECISION theta_lut_step=0.00306796157577;
    const FIXED_POINT_EXP theta_lut_step_inverse=325.9493315;

    //#pragma HLS pipeline
    //#pragma HLS ARRAY_PARTITION dim=0 factor=64 type=cyclic variable=cordic_phase

    int entrance_int;

    FIXED_POINT_U_PRECISION current_cos;
    FIXED_POINT_U_PRECISION current_sin;
    FIXED_POINT_PRECISION cordic_theta;
    FIXED_POINT_U_PRECISION temp_theta;    
    FIXED_POINT_U_PRECISION normalized_theta;
    FIXED_POINT_U_PRECISION rest_normalized_theta;
    ap_fixed<25,13> entrance_f;
    ap_int<11> entrance_ap;
    

    FIXED_POINT_PRECISION pi2_ratio,pi_shift,pi2_ratio_trunc;
    
    //printf("input  theta %f \n", theta.to_double());

    pi2_ratio=pi_r_inverse*theta;
    //printf("theta divide 2pi %f \n", pi2_ratio.to_double());

    pi2_ratio_trunc=hls::trunc(pi2_ratio);
    //printf("theta divide 2pi floow %f \n", pi2_ratio_trunc.to_double());

    pi_shift=pi2_ratio_trunc*pi_r;
    //printf(" 2pi shift %f \n", pi_shift.to_double());

    cordic_theta=theta-pi_shift;


    //printf("2 pi normalized theta %f \n", cordic_theta.to_double());




    



    if(cordic_theta>0)
    {
        if(cordic_theta>pi_q1)
        {
            if(cordic_theta>pi_q2)
            {
                if(cordic_theta>pi_q3)
                {
                    cordic_theta=-(pi_r-cordic_theta);
                }
                else
                {
                    cordic_theta=-(cordic_theta-pi_q2);
                }
            }
            else
            {
                cordic_theta=-(cordic_theta-pi_q2);
            }       
        }
        
    }
    else
    {
        if(cordic_theta<-pi_q1)
        {
            if(cordic_theta<-pi_q2)
            {
                if(cordic_theta<-pi_q3)
                {
                    cordic_theta=(pi_r+cordic_theta);
                }
                else
                {
                    cordic_theta=-(cordic_theta+pi_q2);

                }
            }
            else
            {
                cordic_theta=-(cordic_theta+pi_q2);
            }
        }
    }

    //normalized to +- pi/2





    normalized_theta=cordic_theta;
    //printf("normalized theta %f \n", normalized_theta.to_double());

    temp_theta=hls::abs(normalized_theta);
    entrance_f=temp_theta*theta_lut_step_inverse;
    entrance_ap=entrance_f.to_ap_int();

    entrance_int=entrance_ap.to_int();
    //printf("cordic entrance int %d \n",entrance_int);
    //printf("\n");

    if(entrance_int>512)
    {
        entrance_int=512;
    }




    current_sin=sin_lut[entrance_int];
    current_cos=cos_lut[entrance_int];


   rest_normalized_theta=theta_lut[entrance_int];
    //printf(" lut postion %f \n", rest_normalized_theta.to_double());
    rest_normalized_theta=temp_theta-rest_normalized_theta;





    FIXED_POINT_U_PRECISION rest_normalized_theta_in;




    if(normalized_theta<0)
    {
        current_sin=-current_sin;
        rest_normalized_theta_in=-rest_normalized_theta;

    }
    else
    {
        rest_normalized_theta_in=rest_normalized_theta;
    }

    
    
    
    FIXED_POINT_U_PRECISION cordic_sin=current_sin;
    FIXED_POINT_U_PRECISION cordic_cos=current_cos;

    	//current_cos=current_cos*0.60735;

       // printf("sin before cordic %f \n",current_sin.to_double());

    for (int j=START_ITERATION ; j<CORDIC_SIN_ITERATION;j++)
    {
        FIXED_POINT_U_PRECISION cos_shift = cordic_cos >> j;
        FIXED_POINT_U_PRECISION sin_shift = cordic_sin >> j;

        // Determine if we are rotating by a positive or negative angle
        if(rest_normalized_theta_in >= 0) {
            // Perform the rotation,counter clock wise
            cordic_cos = cordic_cos - sin_shift;
            cordic_sin = cordic_sin + cos_shift;
        
            // Determine the new theta
            rest_normalized_theta_in = rest_normalized_theta_in - cordic_phase[j];
            } else {
            // Perform the rotation,clock wise
            
            cordic_cos = cordic_cos + sin_shift;
            cordic_sin = cordic_sin - cos_shift;

            // Determine the new theta
            rest_normalized_theta_in = rest_normalized_theta_in + cordic_phase[j];
            }
    }

    if (rest_normalized_theta<(FIXED_POINT_U_PRECISION)0.0002)
    {
        *sin=current_sin;
    }
    else
    {
        *sin=cordic_sin;

    }
    
}

//cordic_sin_u(FIXED_POINT_U_PRECISION)





void cordic_sin_piecewise(FIXED_POINT_PRECISION theta, FIXED_POINT_U_PRECISION* sin)

{
    #pragma HLS pipeline 
    const FIXED_POINT_U_PRECISION cordic_phase[32]={0.78539816339744828000,0.46364760900080609000,0.24497866312686414000,0.12435499454676144000,0.06241880999595735000,0.03123983343026827700,0.01562372862047683100,0.00781234106010111110,0.00390623013196697180,0.00195312251647881880,0.00097656218955931946,0.00048828121119489829,0.00024414062014936177,0.00012207031189367021,0.00006103515617420877,0.00003051757811552610,0.00001525878906131576,0.00000762939453110197,0.00000381469726560650,0.00000190734863281019,0.00000095367431640596,0.00000047683715820309,0.00000023841857910156,0.00000011920928955078,0.00000005960464477539,0.00000002980232238770,0.00000001490116119385,0.00000000745058059692,0.00000000372529029846,0.00000000186264514923,0.00000000093132257462,0.00000000046566128731};
    const FIXED_POINT_U_PRECISION sin_lut[512]={0,0.003067957,0.006135885,0.009203754,0.01227154,0.01533921,0.01840673,0.02147408,0.02454123,0.02760815,0.0306748,0.03374117,0.03680722,0.03987293,0.04293826,0.04600318,0.04906768,0.0521317,0.05519525,0.05825827,0.06132074,0.06438263,0.06744392,0.07050458,0.07356457,0.07662386,0.07968244,0.08274026,0.08579731,0.08885355,0.09190895,0.0949635,0.09801714,0.1010699,0.1041216,0.1071724,0.1102222,0.113271,0.1163186,0.1193652,0.1224107,0.125455,0.1284981,0.13154,0.1345807,0.1376201,0.1406582,0.143695,0.1467305,0.1497645,0.1527972,0.1558284,0.1588582,0.1618864,0.1649131,0.1679383,0.1709619,0.1739839,0.1770042,0.1800229,0.1830399,0.1860552,0.1890687,0.1920804,0.1950903,0.1980984,0.2011046,0.204109,0.2071114,0.2101118,0.2131103,0.2161068,0.2191012,0.2220936,0.2250839,0.2280721,0.2310581,0.234042,0.2370236,0.240003,0.2429802,0.245955,0.2489276,0.2518978,0.2548656,0.2578311,0.2607941,0.2637547,0.2667128,0.2696683,0.2726214,0.2755718,0.2785197,0.2814649,0.2844075,0.2873475,0.2902847,0.2932191,0.2961509,0.2990798,0.3020059,0.3049292,0.3078496,0.3107671,0.3136818,0.3165934,0.319502,0.3224077,0.3253103,0.3282098,0.3311063,0.3339997,0.3368899,0.3397769,0.3426607,0.3455413,0.3484187,0.3512928,0.3541635,0.357031,0.3598951,0.3627557,0.365613,0.3684668,0.3713172,0.3741641,0.3770074,0.3798472,0.3826834,0.385516,0.388345,0.3911704,0.393992,0.39681,0.3996242,0.4024346,0.4052413,0.4080442,0.4108432,0.4136383,0.4164295,0.4192169,0.4220003,0.4247797,0.4275551,0.4303265,0.4330938,0.4358571,0.4386162,0.4413713,0.4441221,0.4468688,0.4496113,0.4523496,0.4550836,0.4578133,0.4605387,0.4632598,0.4659765,0.4686888,0.4713967,0.4741002,0.4767992,0.4794938,0.4821838,0.4848692,0.4875502,0.4902265,0.4928982,0.4955653,0.4982277,0.5008854,0.5035384,0.5061867,0.5088301,0.5114688,0.5141028,0.5167318,0.519356,0.5219753,0.5245897,0.5271991,0.5298036,0.5324031,0.5349976,0.537587,0.5401714,0.5427508,0.545325,0.5478941,0.550458,0.5530167,0.5555702,0.5581185,0.5606616,0.5631993,0.5657318,0.5682589,0.5707808,0.5732971,0.5758082,0.5783138,0.5808139,0.5833086,0.5857978,0.5882816,0.5907597,0.5932323,0.5956993,0.5981607,0.6006165,0.6030666,0.6055111,0.6079498,0.6103828,0.6128101,0.6152316,0.6176473,0.6200572,0.6224613,0.6248595,0.6272518,0.6296383,0.6320187,0.6343933,0.6367618,0.6391245,0.641481,0.6438316,0.646176,0.6485144,0.6508467,0.6531729,0.6554928,0.6578067,0.6601143,0.6624158,0.664711,0.6669999,0.6692826,0.671559,0.673829,0.6760927,0.67835,0.680601,0.6828455,0.6850837,0.6873153,0.6895406,0.6917592,0.6939715,0.6961771,0.6983762,0.7005688,0.7027547,0.7049341,0.7071068,0.7092728,0.7114322,0.7135848,0.7157308,0.7178701,0.7200025,0.7221282,0.7242471,0.7263591,0.7284644,0.7305627,0.7326543,0.7347389,0.7368166,0.7388873,0.7409511,0.743008,0.7450578,0.7471006,0.7491364,0.7511652,0.7531868,0.7552014,0.7572088,0.7592092,0.7612024,0.7631884,0.7651672,0.7671389,0.7691033,0.7710605,0.7730104,0.7749531,0.7768885,0.7788165,0.7807372,0.7826506,0.7845566,0.7864552,0.7883464,0.7902302,0.7921066,0.7939755,0.7958369,0.7976909,0.7995372,0.8013762,0.8032075,0.8050314,0.8068476,0.8086562,0.8104572,0.8122506,0.8140363,0.8158144,0.8175848,0.8193475,0.8211025,0.8228498,0.8245893,0.8263211,0.8280451,0.8297612,0.8314696,0.8331702,0.8348629,0.8365477,0.8382247,0.8398938,0.841555,0.8432083,0.8448536,0.8464909,0.8481203,0.8497418,0.8513552,0.8529606,0.854558,0.8561473,0.8577286,0.8593018,0.860867,0.862424,0.8639728,0.8655136,0.8670462,0.8685707,0.870087,0.8715951,0.873095,0.8745866,0.8760701,0.8775453,0.8790122,0.8804709,0.8819213,0.8833634,0.8847971,0.8862225,0.8876396,0.8890483,0.8904487,0.8918407,0.8932243,0.8945995,0.8959662,0.8973246,0.8986745,0.9000159,0.9013488,0.9026733,0.9039893,0.9052967,0.9065957,0.9078861,0.909168,0.9104413,0.911706,0.9129622,0.9142098,0.9154487,0.9166791,0.9179008,0.9191139,0.9203183,0.921514,0.9227011,0.9238795,0.9250492,0.9262102,0.9273625,0.9285061,0.9296409,0.9307669,0.9318843,0.9329928,0.9340925,0.9351835,0.9362656,0.937339,0.9384035,0.9394592,0.940506,0.9415441,0.9425732,0.9435934,0.9446048,0.9456073,0.9466009,0.9475856,0.9485614,0.9495282,0.9504861,0.951435,0.952375,0.953306,0.9542281,0.9551412,0.9560453,0.9569404,0.9578264,0.9587035,0.9595715,0.9604305,0.9612805,0.9621214,0.9629533,0.9637761,0.9645898,0.9653944,0.96619,0.9669765,0.9677538,0.9685221,0.9692813,0.9700313,0.9707721,0.9715039,0.9722265,0.97294,0.9736443,0.9743394,0.9750254,0.9757021,0.9763697,0.9770281,0.9776773,0.9783174,0.9789482,0.9795698,0.9801821,0.9807853,0.9813792,0.9819639,0.9825393,0.9831055,0.9836624,0.9842101,0.9847485,0.9852777,0.9857975,0.9863081,0.9868094,0.9873014,0.9877841,0.9882576,0.9887217,0.9891765,0.989622,0.9900582,0.9904851,0.9909027,0.9913108,0.9917098,0.9920993,0.9924796,0.9928504,0.9932119,0.9935641,0.993907,0.9942405,0.9945646,0.9948793,0.9951847,0.9954808,0.9957674,0.9960447,0.9963126,0.9965711,0.9968203,0.9970601,0.9972904,0.9975114,0.997723,0.9979253,0.9981181,0.9983016,0.9984756,0.9986402,0.9987954,0.9989413,0.9990777,0.9992048,0.9993224,0.9994306,0.9995294,0.9996188,0.9996988,0.9997694,0.9998306,0.9998823,0.9999247,0.9999576,0.9999812,0.9999953};
    const FIXED_POINT_U_PRECISION cos_lut[512]={1,0.9999953,0.9999812,0.9999576,0.9999247,0.9998823,0.9998306,0.9997694,0.9996988,0.9996188,0.9995294,0.9994306,0.9993224,0.9992048,0.9990777,0.9989413,0.9987954,0.9986402,0.9984756,0.9983016,0.9981181,0.9979253,0.997723,0.9975114,0.9972904,0.9970601,0.9968203,0.9965711,0.9963126,0.9960447,0.9957674,0.9954808,0.9951847,0.9948793,0.9945646,0.9942405,0.993907,0.9935641,0.9932119,0.9928504,0.9924796,0.9920993,0.9917098,0.9913108,0.9909027,0.9904851,0.9900582,0.989622,0.9891765,0.9887217,0.9882576,0.9877841,0.9873014,0.9868094,0.9863081,0.9857975,0.9852777,0.9847485,0.9842101,0.9836624,0.9831055,0.9825393,0.9819639,0.9813792,0.9807853,0.9801821,0.9795698,0.9789482,0.9783174,0.9776773,0.9770281,0.9763697,0.9757021,0.9750254,0.9743394,0.9736443,0.97294,0.9722265,0.9715039,0.9707721,0.9700313,0.9692813,0.9685221,0.9677538,0.9669765,0.96619,0.9653944,0.9645898,0.9637761,0.9629533,0.9621214,0.9612805,0.9604305,0.9595715,0.9587035,0.9578264,0.9569404,0.9560453,0.9551412,0.9542281,0.953306,0.952375,0.951435,0.9504861,0.9495282,0.9485614,0.9475856,0.9466009,0.9456073,0.9446048,0.9435934,0.9425732,0.9415441,0.940506,0.9394592,0.9384035,0.937339,0.9362656,0.9351835,0.9340925,0.9329928,0.9318843,0.9307669,0.9296409,0.9285061,0.9273625,0.9262102,0.9250492,0.9238795,0.9227011,0.921514,0.9203183,0.9191139,0.9179008,0.9166791,0.9154487,0.9142098,0.9129622,0.911706,0.9104413,0.909168,0.9078861,0.9065957,0.9052967,0.9039893,0.9026733,0.9013488,0.9000159,0.8986745,0.8973246,0.8959662,0.8945995,0.8932243,0.8918407,0.8904487,0.8890483,0.8876396,0.8862225,0.8847971,0.8833634,0.8819213,0.8804709,0.8790122,0.8775453,0.8760701,0.8745866,0.873095,0.8715951,0.870087,0.8685707,0.8670462,0.8655136,0.8639728,0.862424,0.860867,0.8593018,0.8577286,0.8561473,0.854558,0.8529606,0.8513552,0.8497418,0.8481203,0.8464909,0.8448536,0.8432083,0.841555,0.8398938,0.8382247,0.8365477,0.8348629,0.8331702,0.8314696,0.8297612,0.8280451,0.8263211,0.8245893,0.8228498,0.8211025,0.8193475,0.8175848,0.8158144,0.8140363,0.8122506,0.8104572,0.8086562,0.8068476,0.8050314,0.8032075,0.8013762,0.7995372,0.7976909,0.7958369,0.7939755,0.7921066,0.7902302,0.7883464,0.7864552,0.7845566,0.7826506,0.7807372,0.7788165,0.7768885,0.7749531,0.7730104,0.7710605,0.7691033,0.7671389,0.7651672,0.7631884,0.7612024,0.7592092,0.7572088,0.7552014,0.7531868,0.7511652,0.7491364,0.7471006,0.7450578,0.743008,0.7409511,0.7388873,0.7368166,0.7347389,0.7326543,0.7305627,0.7284644,0.7263591,0.7242471,0.7221282,0.7200025,0.7178701,0.7157308,0.7135848,0.7114322,0.7092728,0.7071068,0.7049341,0.7027547,0.7005688,0.6983762,0.6961771,0.6939715,0.6917592,0.6895406,0.6873153,0.6850837,0.6828455,0.680601,0.67835,0.6760927,0.673829,0.671559,0.6692826,0.6669999,0.664711,0.6624158,0.6601143,0.6578067,0.6554928,0.6531729,0.6508467,0.6485144,0.646176,0.6438316,0.641481,0.6391245,0.6367618,0.6343933,0.6320187,0.6296383,0.6272518,0.6248595,0.6224613,0.6200572,0.6176473,0.6152316,0.6128101,0.6103828,0.6079498,0.6055111,0.6030666,0.6006165,0.5981607,0.5956993,0.5932323,0.5907597,0.5882816,0.5857978,0.5833086,0.5808139,0.5783138,0.5758082,0.5732971,0.5707808,0.5682589,0.5657318,0.5631993,0.5606616,0.5581185,0.5555702,0.5530167,0.550458,0.5478941,0.545325,0.5427508,0.5401714,0.537587,0.5349976,0.5324031,0.5298036,0.5271991,0.5245897,0.5219753,0.519356,0.5167318,0.5141028,0.5114688,0.5088301,0.5061867,0.5035384,0.5008854,0.4982277,0.4955653,0.4928982,0.4902265,0.4875502,0.4848692,0.4821838,0.4794938,0.4767992,0.4741002,0.4713967,0.4686888,0.4659765,0.4632598,0.4605387,0.4578133,0.4550836,0.4523496,0.4496113,0.4468688,0.4441221,0.4413713,0.4386162,0.4358571,0.4330938,0.4303265,0.4275551,0.4247797,0.4220003,0.4192169,0.4164295,0.4136383,0.4108432,0.4080442,0.4052413,0.4024346,0.3996242,0.39681,0.393992,0.3911704,0.388345,0.385516,0.3826834,0.3798472,0.3770074,0.3741641,0.3713172,0.3684668,0.365613,0.3627557,0.3598951,0.357031,0.3541635,0.3512928,0.3484187,0.3455413,0.3426607,0.3397769,0.3368899,0.3339997,0.3311063,0.3282098,0.3253103,0.3224077,0.319502,0.3165934,0.3136818,0.3107671,0.3078496,0.3049292,0.3020059,0.2990798,0.2961509,0.2932191,0.2902847,0.2873475,0.2844075,0.2814649,0.2785197,0.2755718,0.2726214,0.2696683,0.2667128,0.2637547,0.2607941,0.2578311,0.2548656,0.2518978,0.2489276,0.245955,0.2429802,0.240003,0.2370236,0.234042,0.2310581,0.2280721,0.2250839,0.2220936,0.2191012,0.2161068,0.2131103,0.2101118,0.2071114,0.204109,0.2011046,0.1980984,0.1950903,0.1920804,0.1890687,0.1860552,0.1830399,0.1800229,0.1770042,0.1739839,0.1709619,0.1679383,0.1649131,0.1618864,0.1588582,0.1558284,0.1527972,0.1497645,0.1467305,0.143695,0.1406582,0.1376201,0.1345807,0.13154,0.1284981,0.125455,0.1224107,0.1193652,0.1163186,0.113271,0.1102222,0.1071724,0.1041216,0.1010699,0.09801714,0.0949635,0.09190895,0.08885355,0.08579731,0.08274026,0.07968244,0.07662386,0.07356457,0.07050458,0.06744392,0.06438263,0.06132074,0.05825827,0.05519525,0.0521317,0.04906768,0.04600318,0.04293826,0.03987293,0.03680722,0.03374117,0.0306748,0.02760815,0.02454123,0.02147408,0.01840673,0.01533921,0.01227154,0.009203754,0.006135885,0.003067957};
    const FIXED_POINT_PRECISION theta_lut[512]={0,0.00306796157577128,0.00613592315154256,0.00920388472731385,0.0122718463030851,0.0153398078788564,0.0184077694546277,0.021475731030399,0.0245436926061703,0.0276116541819415,0.0306796157577128,0.0337475773334841,0.0368155389092554,0.0398835004850267,0.042951462060798,0.0460194236365692,0.0490873852123405,0.0521553467881118,0.0552233083638831,0.0582912699396544,0.0613592315154256,0.0644271930911969,0.0674951546669682,0.0705631162427395,0.0736310778185108,0.0766990393942821,0.0797670009700533,0.0828349625458246,0.0859029241215959,0.0889708856973672,0.0920388472731385,0.0951068088489097,0.098174770424681,0.101242732000452,0.104310693576224,0.107378655151995,0.110446616727766,0.113514578303537,0.116582539879309,0.11965050145508,0.122718463030851,0.125786424606623,0.128854386182394,0.131922347758165,0.134990309333936,0.138058270909708,0.141126232485479,0.14419419406125,0.147262155637022,0.150330117212793,0.153398078788564,0.156466040364335,0.159534001940107,0.162601963515878,0.165669925091649,0.168737886667421,0.171805848243192,0.174873809818963,0.177941771394734,0.181009732970506,0.184077694546277,0.187145656122048,0.190213617697819,0.193281579273591,0.196349540849362,0.199417502425133,0.202485464000905,0.205553425576676,0.208621387152447,0.211689348728218,0.21475731030399,0.217825271879761,0.220893233455532,0.223961195031304,0.227029156607075,0.230097118182846,0.233165079758617,0.236233041334389,0.23930100291016,0.242368964485931,0.245436926061703,0.248504887637474,0.251572849213245,0.254640810789016,0.257708772364788,0.260776733940559,0.26384469551633,0.266912657092102,0.269980618667873,0.273048580243644,0.276116541819415,0.279184503395187,0.282252464970958,0.285320426546729,0.288388388122501,0.291456349698272,0.294524311274043,0.297592272849814,0.300660234425586,0.303728196001357,0.306796157577128,0.3098641191529,0.312932080728671,0.316000042304442,0.319068003880213,0.322135965455985,0.325203927031756,0.328271888607527,0.331339850183298,0.33440781175907,0.337475773334841,0.340543734910612,0.343611696486384,0.346679658062155,0.349747619637926,0.352815581213697,0.355883542789469,0.35895150436524,0.362019465941011,0.365087427516783,0.368155389092554,0.371223350668325,0.374291312244096,0.377359273819868,0.380427235395639,0.38349519697141,0.386563158547182,0.389631120122953,0.392699081698724,0.395767043274495,0.398835004850267,0.401902966426038,0.404970928001809,0.408038889577581,0.411106851153352,0.414174812729123,0.417242774304894,0.420310735880666,0.423378697456437,0.426446659032208,0.42951462060798,0.432582582183751,0.435650543759522,0.438718505335293,0.441786466911065,0.444854428486836,0.447922390062607,0.450990351638379,0.45405831321415,0.457126274789921,0.460194236365692,0.463262197941464,0.466330159517235,0.469398121093006,0.472466082668777,0.475534044244549,0.47860200582032,0.481669967396091,0.484737928971863,0.487805890547634,0.490873852123405,0.493941813699176,0.497009775274948,0.500077736850719,0.50314569842649,0.506213660002262,0.509281621578033,0.512349583153804,0.515417544729575,0.518485506305347,0.521553467881118,0.524621429456889,0.527689391032661,0.530757352608432,0.533825314184203,0.536893275759974,0.539961237335746,0.543029198911517,0.546097160487288,0.54916512206306,0.552233083638831,0.555301045214602,0.558369006790373,0.561436968366145,0.564504929941916,0.567572891517687,0.570640853093458,0.57370881466923,0.576776776245001,0.579844737820772,0.582912699396544,0.585980660972315,0.589048622548086,0.592116584123857,0.595184545699629,0.5982525072754,0.601320468851171,0.604388430426943,0.607456392002714,0.610524353578485,0.613592315154256,0.616660276730028,0.619728238305799,0.62279619988157,0.625864161457342,0.628932123033113,0.632000084608884,0.635068046184655,0.638136007760427,0.641203969336198,0.644271930911969,0.647339892487741,0.650407854063512,0.653475815639283,0.656543777215054,0.659611738790826,0.662679700366597,0.665747661942368,0.66881562351814,0.671883585093911,0.674951546669682,0.678019508245453,0.681087469821225,0.684155431396996,0.687223392972767,0.690291354548539,0.69335931612431,0.696427277700081,0.699495239275852,0.702563200851624,0.705631162427395,0.708699124003166,0.711767085578938,0.714835047154709,0.71790300873048,0.720970970306251,0.724038931882023,0.727106893457794,0.730174855033565,0.733242816609336,0.736310778185108,0.739378739760879,0.74244670133665,0.745514662912422,0.748582624488193,0.751650586063964,0.754718547639735,0.757786509215507,0.760854470791278,0.763922432367049,0.766990393942821,0.770058355518592,0.773126317094363,0.776194278670134,0.779262240245906,0.782330201821677,0.785398163397448,0.78846612497322,0.791534086548991,0.794602048124762,0.797670009700533,0.800737971276305,0.803805932852076,0.806873894427847,0.809941856003619,0.81300981757939,0.816077779155161,0.819145740730932,0.822213702306704,0.825281663882475,0.828349625458246,0.831417587034017,0.834485548609789,0.83755351018556,0.840621471761331,0.843689433337103,0.846757394912874,0.849825356488645,0.852893318064416,0.855961279640188,0.859029241215959,0.86209720279173,0.865165164367502,0.868233125943273,0.871301087519044,0.874369049094815,0.877437010670587,0.880504972246358,0.883572933822129,0.886640895397901,0.889708856973672,0.892776818549443,0.895844780125214,0.898912741700986,0.901980703276757,0.905048664852528,0.9081166264283,0.911184588004071,0.914252549579842,0.917320511155613,0.920388472731385,0.923456434307156,0.926524395882927,0.929592357458699,0.93266031903447,0.935728280610241,0.938796242186012,0.941864203761784,0.944932165337555,0.948000126913326,0.951068088489098,0.954136050064869,0.95720401164064,0.960271973216411,0.963339934792183,0.966407896367954,0.969475857943725,0.972543819519497,0.975611781095268,0.978679742671039,0.98174770424681,0.984815665822582,0.987883627398353,0.990951588974124,0.994019550549895,0.997087512125667,1.00015547370144,1.00322343527721,1.00629139685298,1.00935935842875,1.01242732000452,1.01549528158029,1.01856324315607,1.02163120473184,1.02469916630761,1.02776712788338,1.03083508945915,1.03390305103492,1.03697101261069,1.04003897418646,1.04310693576224,1.04617489733801,1.04924285891378,1.05231082048955,1.05537878206532,1.05844674364109,1.06151470521686,1.06458266679264,1.06765062836841,1.07071858994418,1.07378655151995,1.07685451309572,1.07992247467149,1.08299043624726,1.08605839782303,1.08912635939881,1.09219432097458,1.09526228255035,1.09833024412612,1.10139820570189,1.10446616727766,1.10753412885343,1.1106020904292,1.11367005200498,1.11673801358075,1.11980597515652,1.12287393673229,1.12594189830806,1.12900985988383,1.1320778214596,1.13514578303537,1.13821374461115,1.14128170618692,1.14434966776269,1.14741762933846,1.15048559091423,1.15355355249,1.15662151406577,1.15968947564154,1.16275743721732,1.16582539879309,1.16889336036886,1.17196132194463,1.1750292835204,1.17809724509617,1.18116520667194,1.18423316824771,1.18730112982349,1.19036909139926,1.19343705297503,1.1965050145508,1.19957297612657,1.20264093770234,1.20570889927811,1.20877686085389,1.21184482242966,1.21491278400543,1.2179807455812,1.22104870715697,1.22411666873274,1.22718463030851,1.23025259188428,1.23332055346006,1.23638851503583,1.2394564766116,1.24252443818737,1.24559239976314,1.24866036133891,1.25172832291468,1.25479628449045,1.25786424606623,1.260932207642,1.26400016921777,1.26706813079354,1.27013609236931,1.27320405394508,1.27627201552085,1.27933997709662,1.2824079386724,1.28547590024817,1.28854386182394,1.29161182339971,1.29467978497548,1.29774774655125,1.30081570812702,1.30388366970279,1.30695163127857,1.31001959285434,1.31308755443011,1.31615551600588,1.31922347758165,1.32229143915742,1.32535940073319,1.32842736230897,1.33149532388474,1.33456328546051,1.33763124703628,1.34069920861205,1.34376717018782,1.34683513176359,1.34990309333936,1.35297105491514,1.35603901649091,1.35910697806668,1.36217493964245,1.36524290121822,1.36831086279399,1.37137882436976,1.37444678594553,1.37751474752131,1.38058270909708,1.38365067067285,1.38671863224862,1.38978659382439,1.39285455540016,1.39592251697593,1.3989904785517,1.40205844012748,1.40512640170325,1.40819436327902,1.41126232485479,1.41433028643056,1.41739824800633,1.4204662095821,1.42353417115788,1.42660213273365,1.42967009430942,1.43273805588519,1.43580601746096,1.43887397903673,1.4419419406125,1.44500990218827,1.44807786376405,1.45114582533982,1.45421378691559,1.45728174849136,1.46034971006713,1.4634176716429,1.46648563321867,1.46955359479444,1.47262155637022,1.47568951794599,1.47875747952176,1.48182544109753,1.4848934026733,1.48796136424907,1.49102932582484,1.49409728740061,1.49716524897639,1.50023321055216,1.50330117212793,1.5063691337037,1.50943709527947,1.51250505685524,1.51557301843101,1.51864098000678,1.52170894158256,1.52477690315833,1.5278448647341,1.53091282630987,1.53398078788564,1.53704874946141,1.54011671103718,1.54318467261295,1.54625263418873,1.5493205957645,1.55238855734027,1.55545651891604,1.55852448049181,1.56159244206758,1.56466040364335,1.56772836521913};
    const int START_ITERATION=9;//log2 (lut_size)
    const FIXED_POINT_U_PRECISION theta_lut_step=0.00306796157577;
    const FIXED_POINT_EXP theta_lut_step_inverse=325.9493315;

    //#pragma HLS pipeline
    //#pragma HLS ARRAY_PARTITION dim=0 factor=64 type=cyclic variable=cordic_phase

    int entrance_int;
    FIXED_POINT_U_PRECISION current_cos;
    FIXED_POINT_U_PRECISION current_sin;
    FIXED_POINT_PRECISION cordic_theta;
    FIXED_POINT_U_PRECISION temp_theta;    
    FIXED_POINT_U_PRECISION normalized_theta;
    FIXED_POINT_U_PRECISION rest_normalized_theta;
    ap_fixed<25,13> entrance_f;
    ap_int<11> entrance_ap;
    

    FIXED_POINT_PRECISION pi2_ratio,pi_shift,pi2_ratio_trunc;
    
    //printf("input  theta %f \n", theta.to_double());

    pi2_ratio=pi_r_inverse*theta;
    //printf("theta divide 2pi %f \n", pi2_ratio.to_double());

    pi2_ratio_trunc=hls::trunc(pi2_ratio);
    //printf("theta divide 2pi floow %f \n", pi2_ratio_trunc.to_double());

    pi_shift=pi2_ratio_trunc*pi_r;
    //printf(" 2pi shift %f \n", pi_shift.to_double());

    cordic_theta=theta-pi_shift;


    //printf("2 pi normalized theta %f \n", cordic_theta.to_double());




    



    if(cordic_theta>0)
    {
        if(cordic_theta>pi_q1)
        {
            if(cordic_theta>pi_q2)
            {
                if(cordic_theta>pi_q3)
                {
                    cordic_theta=-(pi_r-cordic_theta);
                }
                else
                {
                    cordic_theta=-(cordic_theta-pi_q2);
                }
            }
            else
            {
                cordic_theta=-(cordic_theta-pi_q2);
            }       
        }
        
    }
    else
    {
        if(cordic_theta<-pi_q1)
        {
            if(cordic_theta<-pi_q2)
            {
                if(cordic_theta<-pi_q3)
                {
                    cordic_theta=(pi_r+cordic_theta);
                }
                else
                {
                    cordic_theta=-(cordic_theta+pi_q2);

                }
            }
            else
            {
                cordic_theta=-(cordic_theta+pi_q2);
            }
        }
    }

    //normalized to +- pi/2





    normalized_theta=cordic_theta;
    //printf("normalized theta %f \n", normalized_theta.to_double());

    temp_theta=hls::abs(normalized_theta);
    entrance_f=temp_theta*theta_lut_step_inverse;
    entrance_ap=entrance_f.to_ap_int();

    entrance_int=entrance_ap.to_int();
    //printf("cordic entrance int %d \n",entrance_int);
    //printf("\n");



    if(entrance_int>511)
    {
        entrance_int=512;
        current_sin=sin_lut[entrance_int];
    }
    else
    {
        FIXED_POINT_U_PRECISION endpoint,gap,distance_to_lower,distance_to_higher,increment;

        current_sin=sin_lut[entrance_int];

        rest_normalized_theta=theta_lut[entrance_int];
        //printf(" lut postion %f \n", rest_normalized_theta.to_double());
        distance_to_lower=temp_theta-rest_normalized_theta;
        //printf(" lut postion %f \n", rest_normalized_theta.to_double());

        
        endpoint=sin_lut[entrance_int+1];
        gap=endpoint-current_sin;

        increment=gap*theta_lut_step_inverse*distance_to_lower;

        current_sin=current_sin+increment;
        
    }


    if(normalized_theta<0)
    {
        current_sin=-current_sin;
        
    }
 
    *sin=current_sin;


}

//cordic_sin_u(FIXED_POINT_U_PRECISION)

void cordic_sin_default(FIXED_POINT_PRECISION theta, FIXED_POINT_U_PRECISION*sin)
{
    #pragma HLS pipeline
    
    *sin=hls::sin(theta);

}
